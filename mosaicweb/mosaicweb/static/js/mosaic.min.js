var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,e={next:function(){if(d<a.length){var f=d++;return{value:c(f,a[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(a,c,d,e){if(c){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in d||(d[f]={});d=d[f]}a=a[a.length-1];e=d[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
angular.module("mosaicApp").factory("AboutFactory",function(a){var c={about:{},init:function(){a({method:"POST",url:"/about",data:{},headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(a,e){c.about=a.data},function(a){console.log(a)})},developers:[{name:"Arvind Balijepalli",institution:"NIST",email:"",face:"/static/img/face.gif"},{name:"Kyle Briggs",institution:"Univeristy of Ottawa",email:"",face:"/static/img/face.gif"},{name:"Jacob Forstater",institution:"",email:"",face:"/static/img/face.gif"},
{name:"Canute Vaz",institution:"",email:"",face:"/static/img/face.gif"}]};c.init();return c}).controller("AboutCtrl",function(a,c,d,e,f){function g(a,k,d){a.developers=d.developers;a.hide=function(){k.hide()};a.cancel=function(){k.cancel()};a.answer=function(a){k.hide(a)}}function h(a,k){a.hide=function(){k.hide()};a.cancel=function(){k.cancel()};a.answer=function(a){k.hide(a)}}a.aboutFactory=d;a.mosaicConfigModel=e;a.mosaicUtilsModel=f;a.showDevelopers=function(b){c.show({controller:g,templateUrl:"static/partials/developers.tmpl.html",
parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen})};a.showTermsOfUse=function(b){c.show({controller:h,templateUrl:"static/partials/termsofuse.tmpl.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen})}});angular.module("mosaicApp").factory("AdvancedSettingsFactory",function(a,c){var d={selectedFileType:"",originalSettings:{},analysisSettings:{},validatingSettings:!1,origProcAlgo:"",procAlgo:"",controlsUpdateFlag:!1,procAlgoLocalChanges:!1,errorString:"",post:function(){var e=c.defer();a({method:"POST",url:"/validate-settings",data:{analysisSettings:d.analysisSettings},headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(a,c){d.errorString="";e.resolve(a)},function(a){d.errorString=
a.data.errSummary+": "+a.data.errText;e.reject(a)});return e.promise},setUpdateFlags:function(){var a=d.originalSettings,c=angular.fromJson(d.analysisSettings),g=null,h=null;"QDF"==d.selectedFileType?(g=a.qdfTrajIO,h=c.qdfTrajIO):"ABF"==d.selectedFileType?(g=a.abfTrajIO,h=c.abfTrajIO):"BIN"==d.selectedFileType&&(g=a.binTrajIO,h=c.binTrajIO);d.controlsUpdateFlag=a.eventSegment.blockSizeSec!=c.eventSegment.blockSizeSec||g.start!=h.start?!0:!1;d.procAlgoLocalChanges=d.procAlgoChanged(a,c)},procAlgoChanged:function(a,
c){d.origProcAlgo=d.procAlgorithm(a);d.procAlgo=d.procAlgorithm(c);return d.origProcAlgo!=d.procAlgo?!0:d.originalSettings[d.origProcAlgo]!=d.analysisSettings[d.procAlgo]?!0:!1},procAlgorithm:function(a){for(var c in a)if(-1!=["adept","adept2State","cusumPlus"].indexOf(c))return c;return null}};return d}).controller("AdvancedSettingsCtrl",function(a,c,d,e,f,g){a.model=e;a.model.originalSettings=f;a.model.selectedFileType=g;a.model.analysisSettings=JSON.stringify(f,null,"\t");a.number=5;a.getNumber=
function(a){return Array(a)};a.submitSettings=function(){a.model.post().then(function(c){a.model.setUpdateFlags();a.hide()},function(a){console.log(a)})};a.hide=function(){c.hide({status:"OK",analysisSettings:a.model.analysisSettings,controlsUpdateFlag:a.model.controlsUpdateFlag})};a.cancel=function(){a.model.errorString="";c.cancel()}});angular.module("mosaicApp").factory("AnalysisFactory",function(a,c,d,e,f,g,h){var b={bdQuery:"select BlockDepth from metadata where ProcessingStatus='normal' and ResTime > 0.02",bdBins:500,histDensity:!1,showAnalysisControl:!0,analysisSettings:{},eventNumber:1,errorRateColor:"#696969",requireControlUpdate:!1,pageError:!1,contourPlot:{contour:"<img width='90%' src='/static/img/contour.png' layout-padding>"},analysisPlot:{data:[{x:[1,1],y:[1,1],mode:"lines"}],layout:{xaxis:{title:"counts",type:"linear"},
yaxis:{title:"counts",type:"linear"},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)"},options:{}},toggleAnalysisControlFlag:function(){b.showAnalysisControl=!b.showAnalysisControl},startAnalysis:function(){var a=c.defer();e.post("/start-analysis",{settingsString:g.getSettingsString()}).then(function(b,c){a.resolve(b,c)},function(b){a.reject(b)});return a.promise},stopAnalysis:function(){e.post("/stop-analysis",{}).then(function(a,b){},function(a){console.log(a)})},updateAnalysisData:function(a){var k=
c.defer();b.analysisSettings=a;d.sid!=f.sessionID&&(f.sessionID=d.sid);e.post("/analysis-results",a).then(function(a,c){b.analysisPlot=a.data;h.updateErrorStats();k.resolve(a)},function(a){k.reject(a)});return k.promise}};return b}).controller("AnalysisCtrl",function(a,c,d,e,f,g,h){function b(a,b){a.hide=function(){b.hide()};a.cancel=function(){b.cancel()};a.answer=function(a){b.hide(a)}}function k(a,b,c){a.eventNumber=c;a.cancel=function(){b.cancel()};a.eventForward=function(){a.eventNumber++};a.eventBack=
function(){a.eventNumber--;a.eventNumber=Math.max(0,a.eventNumber)}}a.formContainer={};a.model=e;a.mosaicConfigModel=h;a.setupModel=g;a.statsModel=f;a.customFullscreen=!0;a.model.updateAnalysisData({});a.$watch("formContainer.analysisHistogramForm.bdQuery.$pristine",function(){a.model.requireControlUpdate=!0});a.$watch("formContainer.analysisHistogramForm.bdBins.$pristine",function(){a.model.requireControlUpdate=!0});a.$watch("mosaicConfigModel.newDataAvailable",function(){a.mosaicConfigModel.newDataAvailable&&
a.model.updateAnalysisData({})});a.updateControls=function(){a.model.requireControlUpdate=!1;a.formContainer.analysisHistogramForm.$setPristine()};a.showAnalysisLog=function(d){c.show({controller:b,templateUrl:"static/partials/analysislog.tmpl.html",parent:angular.element(document.body),targetEvent:d,clickOutsideToClose:!0,fullscreen:a.customFullscreen}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})};a.showAnalysisSettings=function(){d.path("/setup-analysis/").search({sid:a.mosaicConfigModel.sessionID})};
a.showAnalysisStatistics=function(b){c.show({controller:"AnalysisStatisticsCtrl",templateUrl:"static/partials/analysisstats.tmpl.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})};a.showEventViewer=function(b){c.show({locals:{eventNumber:a.model.eventNumber},controller:k,templateUrl:"static/partials/eventviewer.tmpl.html",
parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen})}});angular.module("mosaicApp").factory("analysisSetupFactory",function(a,c,d,e,f,g,h){var b={dataPath:"",analysisSettings:{},trajPlot:{},trajPlotOriginalCurrent:[],ftypes:["BIN","ABF","QDF"],selectedFileType:"BIN",procAlgoTypes:[{name:"ADEPT",algorithm:"adept"},{name:"ADEPT 2-State",algorithm:"adept2State"},{name:"CUSUM+",algorithm:"cusumPlus"}]};b.selectedProcAlgoType=b.procAlgoTypes[0];b.partAlgoTypes=["Current Threshold"];b.selectedPartAlgoType="Current Threshold";b.currAuto=!0;b.currMeanAuto=0;b.currSigmaAuto=
0;b.currMeanDisplay=100;b.currSigmaDisplay=0;b.currThresholdpA=100;b.currAuto=!1;b.dcOffset=0;b.start=0;b.end="";b.writeEventTS=!1;b.FsKHz=0;b.controlsUpdating=!1;b.controlEnabled=!1;b.modelInit=!1;b.serverError=!1;b.requireControlUpdate=!1;b.getSetupData=function(a,c){var d=e.defer();g.post(a,c).then(function(a,c){if("new-analysis"==a.data.respondingURL)b.trajPlot=a.data.trajPlot,b.trajPlotOriginalCurrent=b.trajPlot.data[0].y,b.currMeanAuto=a.data.currMeanAuto,b.currSigmaAuto=a.data.currSigmaAuto,
b.selectedFileType=a.data.fileType,b.FsKHz=a.data.FsHz/1E3,b.analysisSettings=angular.fromJson(a.data.settingsString),b.procAlgorithmFromSettings(),b.updateLocals(),""!=a.data.warning&&g.showErrorToast("WARNING: "+a.data.warning);else if("processing-algorithm"==a.data.respondingURL){var k=a.data,e;for(e in b.analysisSettings)-1!=["adept","adept2State","cusumPlus"].indexOf(e)&&(delete b.analysisSettings[e],b.analysisSettings[k.procAlgorithmSectionName]=k.procAlgorithm)}b.loadingToast=null;b.controlsUpdating=
!1;b.serverError=!1;b.modelInit=!0;b.requireControlUpdate=!1;d.resolve(a)},function(a){console.log(a);b.errorString=a.data.errType+": "+a.data.errSummary;b.serverError=!0;b.controlsUpdating=!1;d.reject(a)});b.controlsUpdating=!0;return d.promise};b.procAlgorithmFromSettings=function(){b.analysisSettings.hasOwnProperty("adept")?b.selectedProcAlgoType=b.procAlgoTypes[0]:b.analysisSettings.hasOwnProperty("adept2State")?b.selectedProcAlgoType=b.procAlgoTypes[1]:b.analysisSettings.hasOwnProperty("cusumPlus")&&
(b.selectedProcAlgoType=b.procAlgoTypes[2])};b.arrayOffset=function(a,b){return a.map(function(a){return a-b})};b.showLoadingToast=function(){d.show({hideDelay:0,controller:"LoadingToastCtrl",templateUrl:"static/partials/loading-toast-template.tmpl.html"})};b.toggleCurrAuto=function(){b.currAuto&&(b.currMeanDisplay=b.currMeanAuto,b.currSigmaDisplay=b.currSigmaAuto)};b.updateLocals=function(){b.updateCurrAuto();b.updateCurrThresholdpA();b.updateTrajIO();b.procAlgorithmFromSettings();b.writeEventTS=
b.analysisSettings.eventSegment.writeEventTS?!0:!1};b.updateCurrAuto=function(){-1==b.analysisSettings.eventSegment.meanOpenCurr||-1==b.analysisSettings.eventSegment.sdOpenCurr?(b.currAuto=!0,b.currMeanDisplay=Math.round(1E3*b.currMeanAuto)/1E3,b.currSigmaDisplay=Math.round(1E3*b.currSigmaAuto)/1E3):(b.currAuto=!1,b.currMeanDisplay=Math.round(1E3*b.analysisSettings.eventSegment.meanOpenCurr)/1E3,b.currSigmaDisplay=Math.round(1E3*b.analysisSettings.eventSegment.sdOpenCurr)/1E3)};b.updateCurrThresholdpA=
function(){b.currThresholdpA=Math.round(100*(Math.abs(b.currMeanDisplay)-b.analysisSettings.eventSegment.eventThreshold*b.currSigmaDisplay))/100};b.updateTrajIO=function(){var a=b.analysisSettings;switch(b.selectedFileType){case "QDF":b.start=a.qdfTrajIO.start;b.end=a.qdfTrajIO.end;b.dcOffset=a.qdfTrajIO.dcOffset;break;case "ABF":b.start=a.abfTrajIO.start;b.end=a.abfTrajIO.end;b.dcOffset=a.abfTrajIO.dcOffset;break;case "BIN":b.start=a.binTrajIO.start;b.end=a.binTrajIO.end;b.dcOffset=a.binTrajIO.dcOffset;
break;default:b.start=0,b.end="",b.dcOffset=0}};b.reconcileSettings=function(){var a=b.analysisSettings;b.currAuto?(a.eventSegment.meanOpenCurr=-1,a.eventSegment.sdOpenCurr=-1):(a.eventSegment.meanOpenCurr=b.currMeanDisplay,a.eventSegment.sdOpenCurr=b.currSigmaDisplay);a.eventSegment.eventThreshold=(b.currMeanDisplay-b.currThresholdpA)/b.currSigmaDisplay;a.eventSegment.writeEventTS=b.writeEventTS?1:0;switch(b.selectedFileType){case "QDF":a.qdfTrajIO.start=b.start;a.qdfTrajIO.end=b.end;a.qdfTrajIO.dcOffset=
b.dcOffset;break;case "ABF":a.abfTrajIO.start=b.start;a.abfTrajIO.end=b.end;a.abfTrajIO.dcOffset;break;case "BIN":a.binTrajIO.start=b.start;a.binTrajIO.end=b.end;a.binTrajIO.dcOffset=b.dcOffset;break;default:a.abfTrajIO.start=0,a.abfTrajIO.dcOffset=0}};b.getSettingsString=function(){b.reconcileSettings();return JSON.stringify(b.analysisSettings)};return b}).controller("LoadingToastCtrl",function(a,c){a.hide=function(){c.hide()}}).controller("analysisSetupCtrl",function(a,c,d,e,f,g,h,b){a.model=f;
a.advancedSettingsModel=h;a.analysisModel=g;a.mosaicConfigModel=b;a.$watch("newAnalysisForm.blockSize.$pristine",function(){a.newAnalysisForm.blockSize.$valid&&!a.model.controlsUpdating&&(a.model.requireControlUpdate=!0)});a.$watch("newAnalysisForm.start.$pristine",function(){a.newAnalysisForm.blockSize.$valid&&!a.model.controlsUpdating&&(a.model.requireControlUpdate=!0)});a.$watch("newAnalysisForm.selectedProcAlgoType.$pristine",function(){a.advancedSettingsModel.procAlgoLocalChanges?a.showConfirmDialog("Discard Processing Algorithm Changes?",
"Changes to '"+a.advancedSettingsModel.procAlgo+"' will be lost if you proceed.","Proceed","Cancel").then(function(b){a.model.getSetupData("processing-algorithm",{procAlgorithm:a.model.selectedProcAlgoType.algorithm});a.advancedSettingsModel.procAlgoLocalChanges=!1;a.newAnalysisForm.$setPristine()},function(b){switch(a.advancedSettingsModel.procAlgo){case "adept":a.model.selectedProcAlgoType=a.model.procAlgoTypes[0];break;case "adept2State":a.model.selectedProcAlgoType=a.model.procAlgoTypes[1];break;
case "cusumPlus":a.model.selectedProcAlgoType=a.model.procAlgoTypes[2]}a.newAnalysisForm.$setPristine()}):(a.model.getSetupData("processing-algorithm",{procAlgorithm:a.model.selectedProcAlgoType.algorithm}),a.newAnalysisForm.$setPristine())});a.$watch("model.currThresholdpA",function(){a.newAnalysisForm.blockSize.$valid&&!a.model.controlsUpdating&&(a.model.trajPlot.data[2].y=[a.model.currThresholdpA,a.model.currThresholdpA],a.model.analysisSettings.eventSegment.eventThreshold=(a.model.currMeanDisplay-
a.model.currThresholdpA)/a.model.currSigmaDisplay)});a.selectProcAlgo=function(){console.log(a.model.selectedProcAlgoType)};a.showConfirmDialog=function(a,b,e,g){var f=d.defer();a=c.confirm().title(a).textContent(b).ariaLabel(a).ok(e).cancel(g);c.show(a).then(function(){f.resolve("OKAY")},function(){f.reject("CANCEL")});return f.promise};a.cancel=function(){c.cancel()};a.answer=function(b){var d={};d.answer=b;d.analysisSettings=a.model.analysisSettings;c.hide(d)};a.getFileType=function(){return void 0!==
a.model.selectedFileType?a.model.selectedFileType:"Select a file type"};a.requireControlsUpdate=function(){a.model.requireControlUpdate=!0};a.getPartAlgoType=function(){return void 0!==a.model.selectedPartAlgoType?a.model.selectedPartAlgoType:"Select a parition algorithm"};a.getProcAlgoType=function(){return void 0!==a.model.selectedProcAlgoType?a.model.selectedProcAlgoType.name:"Select a processing algorithm"};a.formDisabled=function(){return a.model.controlsUpdating||a.newAnalysisForm.start.$invalid||
a.newAnalysisForm.end.$invalid||a.newAnalysisForm.blockSize.$invalid||a.mosaicConfigModel.analysisRunning?!0:!1};a.showAdvancedSettings=function(){a.model.reconcileSettings();c.show({skipHide:!0,locals:{analysisSettings:a.model.analysisSettings,selectedFileType:a.model.selectedFileType},controller:"AdvancedSettingsCtrl",templateUrl:"static/partials/advancedSettings.tmpl.html",parent:angular.element(document.body),clickOutsideToClose:!1}).then(function(b){a.model.analysisSettings=angular.fromJson(b.analysisSettings);
a.model.updateLocals();a.model.requireControlUpdate=b.controlsUpdateFlag},function(){a.status="You cancelled the dialog."})};a.updateControls=function(){a.model.reconcileSettings();a.model.getSetupData("/new-analysis",{settingsString:JSON.stringify(a.model.analysisSettings),dataPath:a.model.dataPath}).then(function(b){a.newAnalysisForm.start.$setValidity("max",!0)},function(b){b.data.errType="EmptyDataPipeError";a.newAnalysisForm.start.$setValidity("max",!1)});a.model.requireControlUpdate=!1;a.newAnalysisForm.$setPristine()};
a.startAnalysis=function(){g.startAnalysis().then(function(b,c){e.path("/analysis/").search({sid:a.mosaicConfigModel.sessionID})},function(a){console.log(a)});a.model.controlsUpdating=!1}});angular.module("mosaicApp").factory("AnalysisStatisticsFactory",function(a,c,d,e){var f={analysisStats:{},errorPercent:0,warnPercent:0,updateErrorStats:function(){null!=e.sessionID&&d.post("/analysis-statistics",{}).then(function(a,c){f.analysisStats=a.data;f.errorPercent=Math.round(1E4*f.analysisStats.fractionError)/100;f.warnPercent=Math.round(1E4*f.analysisStats.fractionWarn)/100;f.errorStats.data[0].x=[a.data.fractionNormal*a.data.nTotal];f.errorStats.data[1].x=[a.data.fractionWarn*a.data.nTotal];
f.errorStats.data[2].x=[a.data.fractionError*a.data.nTotal]},function(a){console.log(a)})},errorStats:{data:[{name:"normal",x:[200],y:[0],orientation:"h",marker:{color:"rgb(16, 108, 200)"},width:.5,type:"bar"},{name:"warn",x:[42],y:[0],orientation:"h",type:"bar",marker:{color:"rgb(255,153,51)"},width:.5},{name:"error",x:[14],y:[0],orientation:"h",type:"bar",marker:{color:"rgb(255, 41, 41)"},width:.5}],layout:{xaxis:{autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!1,ticks:"",showticklabels:!1},
yaxis:{autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!1,ticks:"",showticklabels:!1},barmode:"stack",showlegend:!0,legend:{x:1,y:0,traceorder:"normal",font:{family:"Roboto, Helvetica",size:12,color:"#000"}},margin:{l:10,r:0,b:0,t:0,pad:0},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",hovermode:"x",height:75},options:{}}};f.updateErrorStats();return f}).controller("AnalysisStatisticsCtrl",function(a,c,d,e){a.model=e;a.customFullscreen=!0;a.updateStats=function(){d(function(){a.model.updateErrorStats()},
5E3)};a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)}});(function(){angular.module("plotly",[]).directive("plotly",["$window",function(a){return{restrict:"E",template:"<div></div>",scope:{plotlyData:"=",plotlyLayout:"=",plotlyOptions:"=",plotlyEvents:"=",plotlyManualDataUpdate:"="},link:function(c,d){function e(){c.plotlyData?(h||(h=!0,Plotly.newPlot(g,c.plotlyData,c.plotlyLayout,c.plotlyOptions),c.plotlyEvents&&c.plotlyEvents(g)),g.layout=c.plotlyLayout,g.data=c.plotlyData,Plotly.redraw(g)):h&&(Plotly.Plots.purge(g),g.innerHTML="")}function f(){h&&c.plotlyData&&
Plotly.Plots.resize(g)}var g=d[0].children[0],h=!1;c.$watch(function(a){return a.plotlyLayout},function(a,c){angular.equals(a,c)&&h||e()},!0);c.plotlyManualDataUpdate||c.$watch(function(a){return a.plotlyData},function(a,c){angular.equals(a,c)&&h||e()},!0);c.$on("tracesUpdated",function(){e()});c.$watch(function(){return{h:d[0].offsetHeight,w:d[0].offsetWidth}},function(a,c){angular.equals(a,c)||f()},!0);angular.element(a).bind("resize",f)}}}])})();angular.module("mosaicApp",["ngRoute","ngMaterial","ngMessages","ngAnimate","plotly"]).config(function(a){a.definePalette("mosaicPrimary",{50:"#6573d5",100:"#5161d0",200:"#3d4eca",300:"#3343bb",400:"#2d3ca7",500:"#283593",600:"#232e7f",700:"#1d276b",800:"#181f57",900:"#121843",A100:"#7985db",A200:"#8d97e0",A400:"#a1aae6",A700:"#0d112f",contrastDefaultColor:"light",contrastDarkColors:"50 100 200 300 A100 A400".split(" ")});a.definePalette("mosaicAccent",{50:"#b3b3b3",100:"#bfbfbf",200:"#cccccc",300:"#d9d9d9",
400:"#e6e6e6",500:"#f2f2f2",600:"#ffffff",700:"#ffffff",800:"#ffffff",900:"#ffffff",A100:"#ffffff",A200:"#ffffff",A400:"#f2f2f2",A700:"#ffffff",contrastDefaultColor:"dark",contrastDarkColors:"50 100 200 300 A100 A400".split(" ")});a.theme("default").primaryPalette("mosaicPrimary").accentPalette("mosaicAccent")}).config(function(a,c){c.hashPrefix("");a.when("/",{templateUrl:"/static/partials/index.html"}).when("/about/",{templateUrl:"/static/partials/about.html",controller:"AboutCtrl"}).when("/setup-analysis/",
{templateUrl:"/static/partials/setupAnalysis.html",controller:"analysisSetupCtrl"}).when("/analysis/",{templateUrl:"/static/partials/analysis.html",controller:"AnalysisCtrl"}).when("/wait/",{templateUrl:"/static/partials/wait.html"}).otherwise({redirectTo:"/"})}).controller("AppCtrl",function(a,c,d,e,f,g,h,b,k,l,m){a.location=e;a.customFullscreen=!0;a.AnalysisLoading=!1;a.analysisModel=m;a.mosaicConfigModel=b;a.mosaicUtilsModel=k;a.setupNewAnalysis=function(b){a.newAnalysisFileListing(b);a.AnalysisLoading=
!0};a.newAnalysisFileListing=function(b){c.show({controller:"fileListingCtrl",templateUrl:"static/partials/filelisting.tmpl.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen}).then(function(b){l.dataPath=b.filename.relpath;l.getSetupData("/new-analysis",{dataPath:l.dataPath}).then(function(b){a.showNewAnalysisSettings()},function(b){a.AnalysisLoading=!1})},function(){a.AnalysisLoading=!1})};a.showNewAnalysisSettings=function(){a.AnalysisLoading=
!1;e.path("/setup-analysis/").search({sid:a.mosaicConfigModel.sessionID})};a.returnToAnalysis=function(){e.path("/analysis/")};a.aboutMosaic=function(){e.path("/about/")};a.pageBack=function(){f.history.back()}});angular.module("mosaicApp").controller("ConfirmDialogCtrl",function(a,c){a.showConfirmDialog=function(d,e,f,g){d=c.confirm().title(d).textContent(e).ariaLabel(d).ok(f).cancel(g);c.show(d).then(function(){a.status="OKAY"},function(){a.status="CANCEL"})}});angular.module("mosaicApp").factory("FileListingFactory",function(a,c){var d={toolbarTitle:"Load Data",subheading:"Data Root",selectedIndex:null,fileList:[],post:function(e){var f=c.defer();a({method:"POST",url:"/list-data-folders",data:e,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(a,c){var b=a.data.dataFolders;0<Object.keys(b).length&&(d.subheading=a.data.level,d.fileList=b,d.selectedIndex=null);f.resolve(a)},function(a){f.reject(a)});return f.promise},init:function(){d.post({level:d.subheading})},
upOneLevel:function(){var a=d.subheading.split("/");2==a.length?d.post({level:"Data Root"}):d.post({level:a.slice(0,-2).join()})}};d.init();return d}).controller("fileListingCtrl",function(a,c,d){a.model=d;a.loadData=function(){a.model.post().then(function(c){a.hide()},function(a){console.log(a)})};a.hide=function(){c.hide({status:"OK"})};a.answer=function(d){c.hide({status:d,filename:a.model.fileList[a.model.selectedIndex]})};a.cancel=function(){c.cancel()};a.folderDblClick=function(c){a.model.post({level:"Data Root/"==
a.model.subheading?a.model.fileList[c].name:a.model.subheading+a.model.fileList[c].name})};a.selectItem=function(c){a.model.selectedIndex=c}});angular.module("mosaicApp").factory("mosaicConfigFactory",function(a,c){return{sessionID:null,analysisRunning:!1,newDataAvailable:!1}});angular.module("mosaicApp").factory("mosaicUtilsFactory",function(a,c,d,e,f,g){var h={post:function(b,d){var e=c.defer();null!=g.sessionID&&(d.sessionID=g.sessionID);a({method:"POST",url:b,data:d,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(a,b){"sessionID"in a.data&&(g.sessionID=a.data.sessionID);"analysisRunning"in a.data&&(g.analysisRunning=a.data.analysisRunning);"newDataAvailable"in a.data&&(g.newDataAvailable=a.data.newDataAvailable);e.resolve(a)},function(a){h.showErrorToast(a.data.errSummary);
e.reject(a)});return e.promise},returnToAnalysis:function(){d.path("/analysis/").search({sid:g.sessionID})},showErrorToast:function(a){a=f.simple().position("bottom left").textContent(a).action("DISMISS").highlightAction(!0).highlightClass("md-warn").hideDelay(7E3);f.show(a).then(function(a){"ok"==a&&(h.serverError=!1)})},pollAnalysisStatus:function(){e(function(){g.analysisRunning&&h.post("/poll-analysis-status",{})},5E3)}};h.pollAnalysisStatus();return h});
