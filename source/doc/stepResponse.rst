.. _stepresponse-page:

Step Response Analysis
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This algorithm limits the generalized algorithm for state-detection :cite:`Balijepalli:2014ft` to cases with a single state as seen in the figure below. This simplified approach speeds up the analysis considerably and is appropriate to use for many applications, for example the detection of PEG, small molecules, DNA homopolymers, etc. The :py:class:`~mosaic.stepResponseAnalysis.stepResponseAnalysis` class uses a simplified form of the expression for the ionic current across a nanopore as shown below. This functional form is fit to a time-series from a single event to recover optimal parameters for the mdoel.

.. math::
    i(t)=i_0 + a \left[ \left(e^{-(t+\mu_1)/\tau} -1\right) H\left(t-\mu_1\right)  + \left(1- e^{-(t+\mu_2)/\tau} \right)H\left(t-\mu_2\right) \right]

This simplification speeds up the analysis for two state events like the PEG event in the figure below. The figure shows the results of the fit (or meta-data) superimposed on the time-series of a single event. 

.. figure:: ../images/StepResponse.png
   :width: 50 %
   :align: center

Meta-data for individual events generated by :py:class:`~mosaic.stepResponseAnalysis.stepResponseAnalysis` can be queried using SQLite_ as described in the :ref:`database-page` section. A list of meta-data stored by the step response algorithm is given below.


.. sourcecode:: python

	[recIDX, ProcessingStatus, OpenChCurrent, BlockedCurrent, EventStart, EventEnd, BlockDepth, ResTime, RCConstant, AbsEventStart, ReducedChiSquared, TimeSeries]